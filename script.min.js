let duration=.4,isDay=!0,scale=30,toNightAnimation=gsap.timeline();window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches||toNightAnimation.pause(),toNightAnimation.to("#circle",{duration:duration,ease:"power4.in",scaleX:scale,scaleY:scale,x:1,transformOrigin:"100% 50%"},0).set("#circle",{scaleX:-scale},duration).to("#circle",{duration:duration,ease:"power4.out",scaleX:-1,scaleY:1,x:2},duration).fromTo(".filter",{filter:"brightness(100%)"},{filter:"brightness(50%)",duration:duration},0).to(".nmtext,.nmbar",{color:"white",duration:2*duration},0).to(".nmbar",{background:"rgba(0,0,0,.3)",duration:2*duration},0).fromTo(".nmbar",{boxShadow:"0 0 18px rgba(70, 70, 40, .255)"},{boxShadow:"0 0 18px rgba(0, 0, 0, .255)",duration:duration},0).to("#cloud1",{fill:"#101010",duration:2*duration},0).to("#cloud2",{fill:"#191919",duration:2*duration},0).to("#cloud3",{fill:"#2a2a2a",duration:2*duration},0).to("#sun",{fill:"#3e3f57",duration:2*duration},0).to("#sunburst",{display:"none",duration:2*duration},0);let stars=Array.from(document.getElementsByClassName("star"));stars.map((e=>gsap.to(e,{duration:"random(0.4, 1.5)",repeat:-1,yoyo:!0,opacity:"random(0.2, 0.5)"}))),gsap.to(".clouds-big",{duration:15,repeat:-1,x:-74,ease:"linear"}),gsap.to(".clouds-medium",{duration:20,repeat:-1,x:-65,ease:"linear"}),gsap.to(".clouds-small",{duration:25,repeat:-1,x:-71,ease:"linear"});let switchToggle=document.getElementById("input");switchToggle.addEventListener("change",(()=>toggle()));let toggle=()=>{isDay=!0===switchToggle.checked,isDay?toNightAnimation.reverse():toNightAnimation.play()};function clickEffect(e){var t=document.createElement("div");t.className="clickEffect",t.style.top=e.clientY+"px",t.style.left=e.clientX+"px",document.body.appendChild(t),t.addEventListener("animationend",function(){t.parentElement.removeChild(t)}.bind(this))}document.addEventListener("click",clickEffect);var bid=document.getElementById("search_baidu");function baidu(e){var t=e.s.length,n=document.getElementById("keywordb"),a=document.getElementById("googlebar");0===t?(n.style.display="none",a.style.display="block"):(n.style.transform="scaleY(1)",n.style.display="block",a.style.display="none");for(var o="",i=0;i<t;i++)o+="<span>"+e.s[i]+"</span>";n.innerHTML=o;for(i=0;i<n.children.length;i++){n.children[i].onclick=function(){bid.value=this.innerHTML,bid.focus(),tobaidu()}}document.body.addEventListener("click",(function(e){var t=e.target;"keywordb"!==t.id&&"baidubar"!==t.id&&"search_baidu"!==t.id&&(n.style.transform="scaleY(0)",a.style.display="block",n.style.display="none")}),!1)}bid.addEventListener("keyup",(function(){if(bid.value){var e=document.createElement("script");e.type="text/javascript",e.src="https://suggestion.baidu.com/su?wd="+bid.value+"&cb=baidu";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}),!1);var gid=document.getElementById("search_google");function google(e){var t=e[1].length,n=document.getElementById("keywordg"),a=document.getElementById("baidubar");0===t?(n.style.display="none",a.style.display="block"):(n.style.transform="scaleY(1)",n.style.display="block",a.style.display="none");for(var o="",i=0;i<t;i++)o+="<span>"+e[1][i]+"</span>";n.innerHTML=o;for(i=0;i<n.children.length;i++){n.children[i].onclick=function(){gid.value=this.innerHTML,gid.focus(),togoogle()}}document.body.addEventListener("click",(function(e){var t=e.target;"keywordb"!==t.id&&"googlebar"!==t.id&&"search_google"!==t.id&&(n.style.transform="scaleY(0)",a.style.display="block",n.style.display="none")}),!1)}function tobaidu(){return""!==bid.value&&(window.location.href="https://www.baidu.com/s?wd="+bid.value,bid.value=""),!1}function togoogle(){return""!==gid.value&&(window.location.href="https://www.google.com/search?q="+gid.value,gid.value=""),!1}gid.addEventListener("keyup",(function(){if(gid.value){var e=document.createElement("script");e.type="text/javascript",e.src="https://suggestqueries.google.com/complete/search?q="+gid.value+"&output=firefox&callback=google";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}),!1),gsap.registerPlugin(MotionPathPlugin);var container=document.getElementById("weathercontainer"),card=document.getElementById("card");window.innerWidth<=717&&card.classList.remove("nmbar");var lightningTimeout,innerSVG=Snap("#inner"),outerSVG=Snap("#outer"),backSVG=Snap("#back"),weatherContainer1=Snap.select("#layer1"),weatherContainer2=Snap.select("#layer2"),weatherContainer3=Snap.select("#layer3"),innerRainHolder1=weatherContainer1.group(),innerRainHolder2=weatherContainer2.group(),innerRainHolder3=weatherContainer3.group(),innerLeafHolder=weatherContainer1.group(),innerSnowHolder=weatherContainer1.group(),innerLightningHolder=weatherContainer1.group(),leafMask=outerSVG.rect(),leaf=Snap.select("#leaf"),sun=Snap.select("#sun"),sunburst=Snap.select("#sunburst"),outerSplashHolder=outerSVG.group(),outerLeafHolder=outerSVG.group(),outerSnowHolder=outerSVG.group();outerLeafHolder.attr({"clip-path":leafMask});var sizes={container:{width:0,height:0},card:{width:0,height:0}},clouds=[{group:Snap.select("#cloud1")},{group:Snap.select("#cloud2")},{group:Snap.select("#cloud3")}],weather=[{type:"snow"},{type:"wind"},{type:"rain"},{type:"thunder"},{type:"sun"},{type:"cloud"},{type:"haze"},{type:"drizzle"},{type:"clearwind"}],settings={windSpeed:2,rainCount:0,leafCount:0,snowCount:0,cloudHeight:100,cloudSpace:30,cloudArch:50,renewCheck:10,splashBounce:80},tickCount=0,rain=[],leafs=[],snow=[];function init(e){onResize();for(var t=0;t<clouds.length;t++)clouds[t].offset=Math.random()*sizes.card.width,drawCloud(clouds[t],t);gsap.set(sunburst.node,{opacity:0}),changeWeather(weather[e])}function onResize(){sizes.container.width=container.offsetWidth,sizes.container.height=container.offsetHeight,sizes.card.width=card.offsetWidth,sizes.card.height=card.offsetHeight,innerSVG.attr({width:sizes.card.width,height:sizes.card.height}),outerSVG.attr({width:sizes.container.width,height:sizes.container.height}),backSVG.attr({width:sizes.container.width,height:sizes.container.height}),gsap.set(sunburst.node,{transformOrigin:"50% 50%",x:sizes.container.width/2,y:sizes.container.height/2}),gsap.fromTo(sunburst.node,20,{rotation:0},{rotation:360,repeat:-1,ease:"power0.inOut"}),leafMask.attr({x:0,y:0,width:sizes.container.width,height:sizes.container.height})}function drawCloud(e,t){var n=settings.cloudSpace*t+settings.cloudHeight,a=n+settings.cloudArch+Math.random()*settings.cloudArch,o=sizes.card.width,i=[];i.push("M"+[-o,0].join(",")),i.push([o,0].join(",")),i.push("Q"+[2*o,n/2].join(",")),i.push([o,n].join(",")),i.push("Q"+[.5*o,a].join(",")),i.push([0,n].join(",")),i.push("Q"+[-.5*o,a].join(",")),i.push([-o,n].join(",")),i.push("Q"+[-2*o,n/2].join(",")),i.push([-o,0].join(","));var r=i.join(" ");e.path||(e.path=e.group.path()),e.path.animate({d:r},0)}function makeRain(){var e=3*Math.random(),t="thunder"==currentWeather.type?35:14,n=Math.random()*(sizes.card.width-40)+20,a=this["innerRainHolder"+(3-Math.floor(e))].path("M0,0 0,"+t).attr({fill:"none",stroke:"thunder"==currentWeather.type?"#777":"#0000ff",strokeWidth:e});rain.push(a),gsap.fromTo(a.node,{x:n,y:0-t},{duration:1,delay:Math.random(),y:sizes.card.height,ease:"power2.in",onComplete:onRainEnd,onCompleteParams:[a,e,n,currentWeather.type]})}function onRainEnd(e,t,n,a){for(var o in e.remove(),e=null,rain)rain[o].paper||rain.splice(o,1);rain.length<settings.rainCount&&(makeRain(),t>2&&makeSplash(n,a))}function makeSplash(e,t){var n="thunder"==t?30:20,a="thunder"==t?120:100,o="thunder"==t?.7:.5,i=0-Math.random()*a,r=80*Math.random()-40,s=[];s.push("M0,0"),s.push("Q"+r+","+i),s.push(2*r+",80");var d=outerSplashHolder.path(s.join(" ")).attr({fill:"none",stroke:"thunder"==t?"#777":"#0000ff",strokeWidth:1}),l=Snap.path.getTotalLength(d),c=(sizes.container.width-sizes.card.width)/2,u=(sizes.container.height-sizes.card.height)/2+sizes.card.height;d.node.style.strokeDasharray=n+" "+l,gsap.fromTo(d.node,{strokeWidth:2,y:u,x:c+20+e,opacity:1,strokeDashoffset:n},{duration:o,strokeWidth:0,strokeDashoffset:-l,opacity:1,onComplete:onSplashComplete,onCompleteParams:[d],ease:"slow(0.4, 0.1, false)"})}function onSplashComplete(e){e.remove(),e=null}function makeLeaf(){var e,t,n,a,o,i=.5+.5*Math.random(),r=sizes.card.height/2,s=r+Math.random()*r,d=s-(Math.random()*(2*r)-r),l=["#76993E","#4A5E23","#6D632F"],c=l[Math.floor(Math.random()*l.length)];if(i>.8){t=leaf.clone().appendTo(outerLeafHolder).attr({fill:c}),n=(sizes.container.width-sizes.card.width)/2,s+=10,d+=10,o=(sizes.container.width+n)/2,a=sizes.container.width+50,leafs.push(t);var u=[{x:n,y:s},{x:o,y:Math.random()*d+d/3},{x:a,y:d}];gsap.fromTo(t.node,{rotation:180*Math.random(),x:n,y:r+Math.random()*r+10,scale:i},{duration:2,rotation:360*Math.random(),motionPath:u,onComplete:onLeafEnd,onCompleteParams:[t],ease:"power0.in"})}else{e=leaf.clone().appendTo(innerLeafHolder).attr({fill:c}),n=-100,o=sizes.card.width/2,a=sizes.card.width+50,leafs.push(e);u=[{x:n,y:s},{x:o,y:Math.random()*d+d/3},{x:a,y:d}];gsap.fromTo(e.node,{rotation:180*Math.random(),x:n,y:r+Math.random()*r,scale:i},{duration:2,rotation:360*Math.random(),motionPath:u,onComplete:onLeafEnd,onCompleteParams:[e],ease:"power0.in"})}}function onLeafEnd(e){for(var t in e.remove(),e=null,leafs)leafs[t].paper||leafs.splice(t,1);leafs.length<settings.leafCount&&makeLeaf()}function makeSnow(){var e,t,n=.5+.5*Math.random(),a=20+Math.random()*(sizes.card.width-40),o=-10;n>.8?(e=outerSnowHolder.circle(0,0,5).attr({fill:"white"}),t=sizes.container.height+10,o=(sizes.container.height-sizes.card.height)/2+settings.cloudHeight,a+=(sizes.container.width-sizes.card.width)/2):(e=innerSnowHolder.circle(0,0,5).attr({fill:"white"}),t=sizes.card.height+10),snow.push(e),gsap.fromTo(e.node,{x:a,y:o},{duration:3+5*Math.random(),y:t,onComplete:onSnowEnd,onCompleteParams:[e],ease:"power0.in"}),gsap.fromTo(e.node,{scale:0},{duration:1,scale:n,ease:"power1.inOut"}),gsap.to(e.node,{duration:2,x:a+(150*Math.random()-75),repeat:-1,yoyo:!0,ease:"power1.inOut"})}function onSnowEnd(e){for(var t in e.remove(),e=null,snow)snow[t].paper||snow.splice(t,1);snow.length<settings.snowCount&&makeSnow()}function tick(){++tickCount%settings.renewCheck&&(rain.length<settings.rainCount&&makeRain(),leafs.length<settings.leafCount&&makeLeaf(),snow.length<settings.snowCount&&makeSnow());for(var e=0;e<clouds.length;e++)"sun"==currentWeather.type||"clearwind"==currentWeather.type?(clouds[e].offset>-1.5*sizes.card.width&&(clouds[e].offset+=settings.windSpeed/(e+1)),clouds[e].offset>2.5*sizes.card.width&&(clouds[e].offset=-1.5*sizes.card.width),clouds[e].group.transform("t"+clouds[e].offset+",0")):(clouds[e].offset+=settings.windSpeed/(e+1),clouds[e].offset>sizes.card.width&&(clouds[e].offset=clouds[e].offset-sizes.card.width+0),clouds[e].group.transform("t"+clouds[e].offset+",0"));requestAnimationFrame(tick)}function reset(){for(var e=0;e<weather.length;e++)container.classList.remove(weather[e].type)}function startLightningTimer(){lightningTimeout&&clearTimeout(lightningTimeout),"thunder"==currentWeather.type&&(lightningTimeout=setTimeout(lightning,6e3*Math.random()))}function lightning(){startLightningTimer(),gsap.fromTo(card,{y:-30},{duration:.75,y:0,ease:"elastic"});for(var e=30+Math.random()*(sizes.card.width-60),t=[e+",0"],n=0;n<20;n++){var a=e+(20*Math.random()-10),o=sizes.card.height/20*(n+1);t.push(a+","+o)}var i=weatherContainer1.path("M"+t.join(" ")).attr({fill:"none",stroke:"white",strokeWidth:2+Math.random()});gsap.to(i.node,{duration:1,opacity:0,ease:"power4.out",onComplete:function(){i.remove(),i=null}})}function changeWeather(e){switch(e.data&&(e=e.data),reset(),currentWeather=e,container.classList.add(e.type),e.type){case"cloud":gsap.to(settings,{duration:3,windSpeed:1.5,ease:"power2.inOut"});break;case"wind":gsap.to(settings,{duration:3,windSpeed:8,ease:"power2.inOut"});break;case"sun":case"clearwind":gsap.to(settings,{duration:3,windSpeed:20,ease:"power2.inOut"});break;default:gsap.to(settings,{duration:3,windSpeed:.5,ease:"power2.out"});break}switch(e.type){case"rain":gsap.to(settings,{duration:3,rainCount:20,ease:"power2.inOut"});break;case"drizzle":gsap.to(settings,{duration:3,rainCount:5,ease:"power2.inOut"});break;case"thunder":gsap.to(settings,{duration:3,rainCount:60,ease:"power2.inOut"});break;default:gsap.to(settings,{duration:1,rainCount:0,ease:"power2.out"});break}switch(e.type){case"wind":case"clearwind":gsap.to(settings,{duration:3,leafCount:5,ease:"power2.inOut"});break;default:gsap.to(settings,{duration:1,leafCount:0,ease:"power2.out"});break}switch(e.type){case"snow":gsap.to(settings,{duration:3,snowCount:40,ease:"power2.inOut"});break;default:gsap.to(settings,{duration:1,snowCount:0,ease:"power2.out"});break}switch(e.type){case"sun":case"clearwind":gsap.to(sun.node,{duration:4,x:sizes.card.width/2,y:sizes.card.height/2,ease:"power2.inOut"}),window.innerWidth<=717?gsap.to(sunburst.node,{duration:4,scale:1,opacity:.8,y:sizes.container.height/2-80,ease:"power2.inOut"}):gsap.to(sunburst.node,{duration:4,scale:1,opacity:.8,y:sizes.container.height/2,ease:"power2.inOut"});break;default:gsap.to(sun.node,{duration:2,x:sizes.card.width/2,y:-100,ease:"power2.inOut"}),gsap.to(sunburst.node,{duration:2,scale:.4,opacity:0,y:sizes.container.height/2-50,ease:"power2.inOut"});break}startLightningTimer()}getWeather();var xhr=new XMLHttpRequest;function getWeather(){var e=new XMLHttpRequest;e.open("get","https://api.weatherapi.com/v1/forecast.json?key=d52e8a56753149df85e83459210406&q=auto:ip&days=1"),e.onreadystatechange=function(){if(4===e.readyState){var t=JSON.parse(e.responseText);handleJson(t.location.name,t.current.temp_c,t.current.condition.text,t.current.condition.code,t.current.wind_kph,t.current.humidity,t.forecast.forecastday[0])}},e.send()}function handleJson(e,t,n,a,o,i,r){document.getElementById("city").innerHTML=e+" &#xe901",document.getElementById("detail").innerHTML=n,document.getElementById("temp").innerHTML=t+"<span>℃</span>";let s,d,l=r.astro.sunrise.split(":"),c=l[1].split(" ")[0],u=r.astro.sunset.split(":"),h=u[1].split(" ")[0];document.getElementById("temprange").innerHTML="<p>"+r.day.mintemp_c+"℃ to "+r.day.maxtemp_c+"℃</p><p> &#xe90b "+i+"%</p><p>&#xe9d6 "+l[0]+":"+c+" to "+u[0]+":"+h+"</p>",1066==a||1069==a||1114==a||1204==a||1207==a||1210==a||1213==a||1216==a||1219==a||1222==a||1225==a||1237==a||1249==a||1252==a||1255==a||1258==a||1261==a||1264==a||1279==a||1282==a?(s=0,d="Snow"):a>1272&&a<1283?(s=3,d="Drizzle"):1e3==a&&o<29?(s=4,d="Clear"):1e3==a?(s=8,d="Wind"):a>1002&&a<1010&&o<29?(s=5,d="Cloud"):a>1002&&a<1010?(s=1,d="Wind"):1030==a||1135==a||1147==a?(s=6,d="Fog"):1072==a||a>1149&&a<1172?s=7:(s=2,d="Rain"),document.getElementById("summary").innerHTML=d,init(s),window.addEventListener("resize",widgetResize),requestAnimationFrame(tick),document.getElementById("time").innerHTML=(new Date).getHours()+":"+checkTime((new Date).getMinutes()),risemin=60*l[0]+c,setmin=60*u[0]+h,setBackground(risemin,setmin)}function printH(e,t,n){document.getElementById("hitokoto").innerHTML=null==t?e+"<p>──《"+n+"》</p>":e+"<p>──"+t+"《"+n+"》</p>"}function widgetResize(){onResize();for(var e=0;e<clouds.length;e++)clouds[e].offset=Math.random()*sizes.card.width,drawCloud(clouds[e],e);changeWeather(currentWeather)}function checkTime(e){return e<10&&(e="0"+e),e}function loadStyleString(e){var t=document.createElement("style");t.type="text/css";try{t.appendChild(document.createTextNode(e))}catch(n){t.styleSheet.cssText=e}document.getElementsByTagName("head")[0].appendChild(t)}function setBackground(e,t){int=(t-e)/8,realmin=60*(new Date).getHours()+(new Date).getMinutes(),realmin<=e-1.5*int?(i="n5.webp",color="#755be3"):realmin>e-1.5*int&&realmin<=e-int/2?(i="n6.webp",color="#2a6a9e"):realmin>e-int/2&&realmin<=e?(i="d0.webp",color="#ed95d1"):realmin>e&&realmin<=e+int/2?(i="d1.webp",color="#de9cd7"):realmin>e+int/2&&realmin<=e+1.5*int?(i="d2.webp",color="#3c82cc"):realmin>e+1.5*int&&realmin<=e+3*int?(i="d3.webp",color="#95bdcc"):realmin>e+3*int&&realmin<=e+4*int?(i="d4.webp",color="#68c9f1"):realmin>e+4*int&&realmin<=e+5*int?(i="d5.webp",color="#2fa0e6"):realmin>e+5*int&&realmin<=e+6*int?(i="d6.webp",color="#6b8b4c"):realmin>e+6*int&&realmin<=e+7.5*int?(i="d7.webp",color="#af5c18"):realmin>e+7.5*int&&realmin<=t?(i="d8.webp",color="#da644f"):realmin>t&&realmin<=t+int/2?(i="n0.webp",color="#b6bbf5"):realmin>t+int/2&&realmin<=t+1.5*int?(i="n1.webp",color="#897ddc"):realmin>t+1.5*int&&realmin<=t+3*int?(i="n2.webp",color="#3e7ee3"):realmin>t+3*int&&realmin<=1320?(i="n3.webp",color="#36315a"):realmin>1320&&(i="n4.webp",color="#3d3d88"),css="#fill_screen{background:url('https://cdn.jsdelivr.net/gh/yihuanlin/yihuanlin.github.io/background/"+i+"') no-repeat local center center/cover;}",metaThemeColor=document.querySelector("meta[name=theme-color]"),metaThemeColor.setAttribute("content",color),loadStyleString(css)}xhr.open("get","https://international.v1.hitokoto.cn/?c=i"),xhr.onreadystatechange=function(){if(4===xhr.readyState){var e=JSON.parse(xhr.responseText);printH(e.hitokoto,e.from_who,e.from)}},xhr.send();